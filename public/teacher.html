<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>BYTEWEBNEST Â· Live Lesson Â· Teacher</title>

  <!-- CodeMirror -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/material-darker.min.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/htmlmixed/htmlmixed.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/edit/closetag.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/edit/closebrackets.min.js"></script>

  <style>
    body {
      margin: 0;
      background: #0f0a1a;
      color: #fff;
      font-family: system-ui;
    }

    header {
      padding: 14px;
      text-align: center;
      font-weight: bold;
      background: linear-gradient(90deg, #7b2ff7, #c09bff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-size: 20px;
    }

    .editor-wrap {
      padding: 12px;
    }

    .CodeMirror {
      height: 65vh;
      font-size: 15px;
      border-radius: 10px;
    }

    button {
      margin-top: 12px;
      width: 100%;
      padding: 14px;
      font-size: 16px;
      background: #7b2ff7;
      border: none;
      border-radius: 10px;
      color: white;
      cursor: pointer;
    }

    button:hover {
      background: #9f6bff;
    }
  </style>
</head>
<body>

<header>BYTEWEBNEST Â· Live Lesson Â· Teacher</header>

<div class="editor-wrap">
  <textarea id="editor">
<!DOCTYPE html>
<html lang="ru">
<body>
<h1>Hello BYTEWEBNEST</h1>
<p>Live coding ðŸš€</p>
</body>
</html>
  </textarea>

  <button id="publishBtn">ÐžÐ¿ÑƒÐ±Ð»Ð¸ÐºÐ¾Ð²Ð°Ñ‚ÑŒ (Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ)</button>
</div>

<script>
  const editor = CodeMirror.fromTextArea(
    document.getElementById("editor"),
    {
      mode: "htmlmixed",
      theme: "material-darker",
      lineNumbers: true,
      autoCloseTags: true,
      autoCloseBrackets: true
    }
  )

  const ws = new WebSocket(`wss://${location.host}`)

  ws.onopen = () => {
    console.log("âœ… WS connected (teacher)")
  }

  document.getElementById("publishBtn").onclick = () => {
    if (ws.readyState !== WebSocket.OPEN) {
      alert("WebSocket ÐµÑ‰Ñ‘ Ð½Ðµ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡Ñ‘Ð½")
      return
    }

    ws.send(JSON.stringify({
      type: "publish",
      lessonId: "lesson-1",
      key: "bwn-live-2025",
      html: editor.getValue()
    }))
  }
</script>

</body>
</html>
